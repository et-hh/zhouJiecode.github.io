(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{221:function(e,n,t){"use strict";t.r(n);var a=t(0),o=Object(a.a)({},(function(){var e=this.$createElement,n=this._self._c||e;return n("ContentSlotsDistributor",{attrs:{"slot-key":this.$parent.slotKey}},[n("p",[this._v("正常情况下，ajax只能接收数据以供代码调用，无法下载文件\n但是可以让后台将文件的base64编码传到前端，前台使用a标签下载文件")]),this._v(" "),n("pre",[n("code",[this._v("this.resetAjax({\n    method: 'get',\n    url: `/device/device/export?${serialize(this.tableSearchCondition)}`,\n    onSuccess(res) {\n        that.saveExcelFile(res.data.data, '设备管理表' + new Data())\n    }\n})\n\nVue.prototype.saveExcelFile = function(data, filename) {\n    // ie下去掉所有换行符，chrome下没有换行符\n    let code = atob(data.replace(/\\r\\n/g, ''))\n    var abuffer = new window.ArrayBuffer(code.length)\n    var uBuffer = new window.Uint8Array(abuffer)\n    for(var i = 0; i < code.length; i++) {\n        uBuffer[i] = code.charCodeAt(i) & 0xff\n    }\n    var blob = new Blob([uBuffer], {\n        type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8'\n    })\n\n    if(window.navigator.msSaveOrOpenBlob) {\n        // iE下使用msSaveBlob进行导出\n        navigator.msSaveBlob(blob, filename)\n    } else {\n        var href = window.URL.createObjectURL(blob)\n        var save_link = document.createElementNS('http://www.w3.org/1999/xhtml', 'a')\n        save_link.href = href\n        save_link.download = filename\n\n        // 解决火狐兼容问题\n        document.body.appendChild(save_link)\n\n        var event = document.createEvent('MouseEvents')\n        event.initMouseEvent('click', true, false, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null)\n        save_link.dispatchEvent(event)\n\n        document.body.removeChild(save_link)\n        window.URL.revokeObjectURL(href)\n    }\n}\n")])]),this._v(" "),n("p",[this._v("最好是ajax请求时设置ContentType为blob，将请求下来的blob直接转为文件下载")])])}),[],!1,null,null,null);n.default=o.exports}}]);