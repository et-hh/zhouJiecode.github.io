(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{219:function(e,n,t){"use strict";t.r(n);var r=t(0),o=Object(r.a)({},(function(){var e=this.$createElement,n=this._self._c||e;return n("ContentSlotsDistributor",{attrs:{"slot-key":this.$parent.slotKey}},[n("pre",[n("code",[this._v("handleDownload() {\n  if (!this.src) {\n     this.$message.error('不存在音频文件')\n     return\n  }\n\n  // var audioCtx = new (window.AudioContext || window.webkitAudioContext)()\n  // var source = audioCtx.createBufferSource()\n\n  const saveExcelFile = (code, filename) => {\n    // ie下去掉所有换行符，chrome下没有换行符\n    // const code = atob(data.replace(/\\r\\n/g, ''))\n    const length = code.length\n\n    var abuffer = code // new window.ArrayBuffer(length)\n    var uBuffer = new window.Uint8Array(abuffer)\n    for (var i = 0; i < length; i++) {\n      uBuffer[i] = code.charCodeAt(i) & 0xff\n    }\n    var blob = new Blob([uBuffer], {\n      // type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8'\n      type: 'audio/x-wav'\n    })\n\n    if (window.navigator.msSaveOrOpenBlob) {\n      // iE下使用msSaveBlob进行导出\n      navigator.msSaveBlob(blob, filename)\n    } else {\n      var href = window.URL.createObjectURL(blob)\n\n      var save_link = document.createElementNS('http://www.w3.org/1999/xhtml', 'a')\n      save_link.href = href\n      save_link.download = filename\n\n      // 解决火狐兼容问题\n      document.body.appendChild(save_link)\n\n      var event = document.createEvent('MouseEvents')\n      event.initMouseEvent('click', true, false, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null)\n      save_link.dispatchEvent(event)\n\n      document.body.removeChild(save_link)\n      window.URL.revokeObjectURL(href)\n    }\n  }\n\n  // this.src && (window.location.href = this.src)\n  var xhr = new XMLHttpRequest()\n  xhr.onreadystatechange = e => { // 服务器返回值的处理函数，此处使用匿名函数进行实现\n    if (xhr.readyState === 4 && xhr.status === 200) {\n      const res = 'response' in xhr ? xhr.response : xhr.responseText // 不是responseText。\n      // audioCtx.decodeAudioData(res, function(buffer) {\n      //   source.buffer = buffer;\n      //   console.log(buffer)\n\n      //   source.connect(audioCtx.destination);\n      //   source.loop = true;\n      // },\n\n      // function(e){\"Error with decoding audio data\" + e.err});\n      saveExcelFile(res, this.downloadName)\n    }\n  }\n  xhr.open('GET', this.src, true) // 提交get请求到服务器\n  xhr.setRequestHeader('Content-Type', 'arraybuffer')\n  xhr.responseType = 'arraybuffer'\n  xhr.send()\n}")])])])}),[],!1,null,null,null);n.default=o.exports}}]);