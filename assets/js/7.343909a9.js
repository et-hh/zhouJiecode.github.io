(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{222:function(s,a,t){"use strict";t.r(a);var n=t(0),r=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h3",{attrs:{id:"项目分为两类："}},[t("a",{staticClass:"header-anchor",attrs:{href:"#项目分为两类：","aria-hidden":"true"}},[s._v("#")]),s._v(" 项目分为两类：")]),s._v(" "),t("p",[s._v("传统未模块化的项目；使用seaJS,requireJS等模块化的项目")]),s._v(" "),t("h3",{attrs:{id:"以requirejs模块化项目为例："}},[t("a",{staticClass:"header-anchor",attrs:{href:"#以requirejs模块化项目为例：","aria-hidden":"true"}},[s._v("#")]),s._v(" 以requireJS模块化项目为例：")]),s._v(" "),t("h4",{attrs:{id:"_1，解析所有非第三方文件的依赖文件路径，并存入对象a，a大概如下："}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1，解析所有非第三方文件的依赖文件路径，并存入对象a，a大概如下：","aria-hidden":"true"}},[s._v("#")]),s._v(" 1，解析所有非第三方文件的依赖文件路径，并存入对象a，a大概如下：")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("a "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./main.js"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./common/a.js'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./lib/b.js'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./page/page1.js"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./common/a.js'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./lib/b.js'")]),s._v("，‘"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("hh"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("js’"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("h4",{attrs:{id:"_2，首先把所有main-js依赖的文件包括main自身打包成一个文件，并将所以已被打包文件存入数组b，b大概如下："}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2，首先把所有main-js依赖的文件包括main自身打包成一个文件，并将所以已被打包文件存入数组b，b大概如下：","aria-hidden":"true"}},[s._v("#")]),s._v(" 2，首先把所有main.js依赖的文件包括main自身打包成一个文件，并将所以已被打包文件存入数组b，b大概如下：")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("b "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n       "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./main.js"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n       "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./common/a.js"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n       "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./lib/b.js'")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),t("h4",{attrs:{id:"_3-遍历所有单个页面模块js，提取出所有公共资源（至少两个模块引用了这个资源），并且去掉已经存在于b数组的资源。将这些资源放置于对象c"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-遍历所有单个页面模块js，提取出所有公共资源（至少两个模块引用了这个资源），并且去掉已经存在于b数组的资源。将这些资源放置于对象c","aria-hidden":"true"}},[s._v("#")]),s._v(" 3,  遍历所有单个页面模块js，提取出所有公共资源（至少两个模块引用了这个资源），并且去掉已经存在于b数组的资源。将这些资源放置于对象c")]),s._v(" "),t("p",[s._v('比如page1.js和page2.js都引用了"\'./common/a.js"和"\'./common/b.js",但是"\'./common/a.js"已经存'),t("br"),s._v('在b中，就只将"\'./common/b.js"放入c；c大致如下：')]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("c "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n       "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./page/page1.js"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("common"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("b"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("js"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n       "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./page/page2.js"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("common"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("b"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("js"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n       "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("p",[s._v("将所有列入c的value数组中的文件push入b"),t("br"),s._v("\n再将c(key->value)中value包含的所有文件打包成一个公共文件，并修改key文件的引用路径")]),s._v(" "),t("h4",{attrs:{id:"_4，再重复遍历所有单个页面模块js，将所有被该模块引用的但不存在b中的文件打包成单个文件并修改引用路径；"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4，再重复遍历所有单个页面模块js，将所有被该模块引用的但不存在b中的文件打包成单个文件并修改引用路径；","aria-hidden":"true"}},[s._v("#")]),s._v(" 4，再重复遍历所有单个页面模块js，将所有被该模块引用的但不存在b中的文件打包成单个文件并修改引用路径；")]),s._v(" "),t("p",[s._v('比如"./page/page3.js"中引入 ./common/b.js 和 ./hh.js 和 test.js ,则把后两者打包成一个公共js并修'),t("br"),s._v('改"./page/page3.js"中的引用路径')]),s._v(" "),t("h4",{attrs:{id:"加版本号"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#加版本号","aria-hidden":"true"}},[s._v("#")]),s._v(" 加版本号")]),s._v(" "),t("p",[s._v("在上面的压缩合并文件后，就可以使用md5工具对压缩合并后的文件进行hash处理，再修改引用"),t("br"),s._v("\n比如将 ./hh.js 和 test.js 打包成 th.min.js 后hash化处理成 th_2213332dfas.min.js, 再修改"),t("br"),s._v("./page/page3.js 中的引用路径")]),s._v(" "),t("h3",{attrs:{id:"非模块化的项目"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#非模块化的项目","aria-hidden":"true"}},[s._v("#")]),s._v(" 非模块化的项目")]),s._v(" "),t("p",[s._v("非模块化的项目一般不会有文件的重复引用，只需要直接将当前页面所有引入资源合并压缩成单个资"),t("br"),s._v("源即可；\n如果的确有多页面之间引用了相同的文件，那么同样可以使用gulp的through工具遍历文件提取公共文"),t("br"),s._v("件进行压缩合并")])])}),[],!1,null,null,null);a.default=r.exports}}]);